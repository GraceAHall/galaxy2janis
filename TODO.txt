

NOTE check janis-patterns github for tricky situations

TODO v0.1


TODO:
    - get output collection working properly
    - galaxy select & bool params are not being expanded incase of multiple flags etc
    - ensure outputs are being transferred to CommandComponents as galaxy_objects

    - write to janis
    - janis test runner
    - add code test suite (pytest)
    
    - high priority bugs
        base_command=["samtools", "faidx", "artic", "minion"] (artic_minion.xml) 

    - med priority bugs
        
    - low priority bugs
        - newick_display.xml R style patterns in cmd string
        - missing datatype for positional (augustus)
        - missing datatype for positional '>' (bcftools)
        - augustus default for kvpairs (--singlestrand=true)
    

Janis tool library
    - parse more successful job invokations (--gene-thresholds in quast.xml)



Desirable

    - bug: --labels option in_inputs being linked to galaxy output var not an input (quast)
    - add support for repeat elements in tests
    - configfiles
    - add CitationManager class from galaxy source 
    - more robust allocation of CommandComponents for galaxy params (some can't be flags, some much more likely to be one rather than another etc)


- tool tests
    - janis has the galaxy tests. parse to janis format
    - galaxy test evalutation - https://github.com/galaxyproject/galaxy/tree/dev/lib/galaxy/tool_util/verify/asserts
    - during tool testing - check whether WilcardSelector can handle the galaxy regex





Milestones to v0.1 -------------------------------

 - galaxy type parsing                          (complete)
 - galaxy types integrated into janis           (richard)
 - improved command string parsing              (complete)
 - small additions (rare params)                (queued) 
 - configfiles (1 day)                          (queued) 
 - tool test platform parsing into janis        (queued)
    - includes ingesting param vals and templating
      command string



Rollout plan -------------------------------------

 - finish v0.1 tasks above
 - integrate passed tools into janis
 - add extra features if necessary to parse remaining tools
 - manually resolve non-passed tools
 - integrate program into janis


Future -------------------------------------------
    
 - workflowstep command loading
    - '__class__': 'ConnectedValue' - do traceback to original dataset
    - '__class__': 'RuntimeValue' - write warning to user stating the value needs to be set on the run

 - paired files & collections (short reads, composite types imzml)
 - new tools added to toolshed automatically parsed 
 - any which do not pass tests can have manual intervention (fornight / monthly activity)
 - start galaxy workflow parser -> janis


Notes --------------------------------------------

Multithreading
    - added multithreading because 'requests' module takes too long to ping biocontainers
    - making 50-100 requests per sec to quay.io: am I gonna get banned? 
    - doing this every 5 mins - 10 mins when i make changes and want to re-parse all tools-iuc tools

- Galaxy types
    - composite types like imzML? is there info on secondary type? 
    - that kind of extra data can be found in the actual type class def. needed?  

non-wildcard Outputs
    - currently just keeping as WilcardSelector. Not sure how glob works and is deprecated. 
    - glob="output.fastq" works when path is directly known
    - stringformatter for paths ie concatenating folder and filename

Containers
    - Only using latest biocontainer version

Macros
    - supports common macros? is this done? 

Helptext
    - restructuredText processing to make helptext nicer


v0.1 Features ------------------------------------

- automatic container detection
    - just pings url using python 'requests' module
    - cache stores previously checked urls

- logging for tools which can't currently be parsed
    - complex regex
    - types
    - uses configfile
    - needs user input (datatype / command line references) *
    - unresolved container url


